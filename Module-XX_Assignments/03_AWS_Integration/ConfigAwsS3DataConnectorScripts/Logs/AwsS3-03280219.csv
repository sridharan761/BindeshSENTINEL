"Time","Message","Severity"
"28-03-2024 02:19","Starting ConfigAwsConnector at: 03/28/2024 02:19:24","Information"
"28-03-2024 02:19","Log created: C:\Users\ServerX\Downloads\ConfigAwsS3DataConnectorScripts\Logs\AwsS3-03280219.csv","Information"
"28-03-2024 02:19","To begin you will choose the AWS logs to configure.","Information"
"28-03-2024 02:19","Checking AWS CLI configuration...","Information"
"28-03-2024 02:19","Starting CloudTrail data connector configuration script","Verbose"
"28-03-2024 02:19","This script creates an Assume Role with minimal permissions to grant Azure Sentinel access to your logs in a designated S3 bucket & SQS of your choice, enable CloudTrail Logs, S3 bucket, SQS Queue, and S3 notifications.","Information"
"28-03-2024 02:19","Notes:","Information"
"28-03-2024 02:19","* You can find more information about the script in https://github.com/Azure/Azure-Sentinel/blob/master/DataConnectors/AWS-S3/README.md","Information"
"28-03-2024 02:19","* If a resource name(like: S3, Sqs, Kms) already exists, the script will use the available one and not create a new resource","Information"
"28-03-2024 02:19","Checking existing OIDC provider","Information"
"28-03-2024 02:19","Executing Set-RetryAction","Verbose"
"28-03-2024 02:19","Executing: aws sts get-caller-identity --query 'Account' --output text","Verbose"
"28-03-2024 02:19","154511248558","Verbose"
"28-03-2024 02:19","Executing: aws iam get-open-id-connect-provider --open-id-connect-provider-arn 'arn:aws:iam::154511248558:oidc-provider/sts.windows.net/33e01921-4d64-4f8c-a055-5bdaffd5e33d/' 2>&1","Verbose"
"28-03-2024 02:19","{     ""Url"": ""sts.windows.net/33e01921-4d64-4f8c-a055-5bdaffd5e33d/"",     ""ClientIDList"": [         ""api://1462b192-27f7-4cb9-8523-0f4ecb54b47e""     ],     ""ThumbprintList"": [         ""626d44e704d1ceabe3bf0d53397464ac8080142c""     ],     ""CreateDate"": ""2024-03-27T20:17:07.684000+00:00"",     ""Tags"": [] }","Verbose"
"28-03-2024 02:19","OIDC provider already exists","Information"
"28-03-2024 02:19","Approved client IDs: api://1462b192-27f7-4cb9-8523-0f4ecb54b47e","Information"
"28-03-2024 02:19","Client ID api://1462b192-27f7-4cb9-8523-0f4ecb54b47e is already approved","Information"
"28-03-2024 02:19","Assume role definition","Information"
"28-03-2024 02:19","Executing Set-RetryAction","Verbose"
"28-03-2024 02:19","Executing: aws iam get-role --role-name AzureSentinelRole 2>&1| Out-Null","Verbose"
"28-03-2024 02:19","Executing: aws iam get-role --role-name AzureSentinelRole","Verbose"
"28-03-2024 02:19","arn:aws:iam::154511248558:role/AzureSentinelRole","Verbose"
"28-03-2024 02:20","Using S3 Bucket name: binsentinellabbucket","Information"
"28-03-2024 02:20","current region configuration: ap-southeast-1","Verbose"
"28-03-2024 02:20","Executing: aws s3api head-bucket --bucket binsentinellabbucket 2>&1","Verbose"
"28-03-2024 02:20","output  2>&1","Verbose"
"28-03-2024 02:20","error code 0 2>&1","Verbose"
"28-03-2024 02:20","Executing: (aws sts get-caller-identity | ConvertFrom-Json).Account","Verbose"
"28-03-2024 02:20","154511248558","Verbose"
"28-03-2024 02:20","Executing: (aws sts get-caller-identity | ConvertFrom-Json).Account","Verbose"
"28-03-2024 02:20","154511248558","Verbose"
"28-03-2024 02:20","Creating SQS queue:","Information"
"28-03-2024 02:20","Using Sqs name: sentinellabqueue","Information"
"28-03-2024 02:20","Executing: aws sqs create-queue --queue-name sentinellabqueue --tags {\""Operator\"": \""Microsoft_Sentinel_Automation_Script\""} 2>&1","Verbose"
"28-03-2024 02:20","System.Management.Automation.RemoteException Error parsing parameter '--tags': Invalid JSON: Expecting property name enclosed in double quotes: line 1 column 2 (char 1) JSON received: {\""Operator\"": \""Microsoft_Sentinel_Automation_Script\""}","Verbose"
"28-03-2024 02:20","File C:\Users\ServerX\Downloads\ConfigAwsS3DataConnectorScripts\ConfigAwsConnector.ps1 cannot be loaded. The file C:\Users\ServerX\Downloads\ConfigAwsS3DataConnectorScripts\ConfigAwsConnector.ps1 is not digitally signed. You cannot run this script on the current system. For more information about running scripts and setting execution policy, see about_Execution_Policies at https://go.microsoft.com/fwlink/?LinkID=135170.","Error"
"28-03-2024 02:20","Retrying...","Information"
"28-03-2024 02:20","Using Sqs name: sentinellabqueue","Information"
"28-03-2024 02:20","Executing: aws sqs create-queue --queue-name sentinellabqueue --tags {\""Operator\"": \""Microsoft_Sentinel_Automation_Script\""} 2>&1","Verbose"
"28-03-2024 02:20","System.Management.Automation.RemoteException Error parsing parameter '--tags': Invalid JSON: Expecting property name enclosed in double quotes: line 1 column 2 (char 1) JSON received: {\""Operator\"": \""Microsoft_Sentinel_Automation_Script\""}","Verbose"
"28-03-2024 02:20","File C:\Users\ServerX\Downloads\ConfigAwsS3DataConnectorScripts\ConfigAwsConnector.ps1 cannot be loaded. The file C:\Users\ServerX\Downloads\ConfigAwsS3DataConnectorScripts\ConfigAwsConnector.ps1 is not digitally signed. You cannot run this script on the current system. For more information about running scripts and setting execution policy, see about_Execution_Policies at https://go.microsoft.com/fwlink/?LinkID=135170.","Error"
"28-03-2024 02:20","Retrying...","Information"
